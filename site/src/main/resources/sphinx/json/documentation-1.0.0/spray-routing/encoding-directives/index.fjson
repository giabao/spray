{"body": "<div class=\"section\" id=\"encodingdirectives\">\n<span id=\"id1\"></span><h1>EncodingDirectives</h1>\n<div class=\"toctree-wrapper compound\">\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"compressResponse/\">compressResponse</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"compressResponseIfRequested/\">compressResponseIfRequested</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"decodeRequest/\">decodeRequest</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"decompressRequest/\">decompressRequest</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"encodeResponse/\">encodeResponse</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"requestEncodedWith/\">requestEncodedWith</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"responseEncodingAccepted/\">responseEncodingAccepted</a></li>\n</ul>\n</div>\n<div class=\"section\" id=\"when-to-use-which-compression-directive\">\n<span id=\"whentousewhichcompressresponsedirective\"></span><h2>When to use which compression directive?</h2>\n<p>There are three different directives for performing response compressing with slightly different behavior:</p>\n<dl class=\"docutils\">\n<dt><a class=\"reference internal\" href=\"encodeResponse/#encoderesponse\"><em>encodeResponse</em></a></dt>\n<dd>Always compresses the response with the one given encoding, rejects the request with an\n<tt class=\"docutils literal\"><span class=\"pre\">UnacceptedResponseEncodingRejection</span></tt> if the client doesn&#8217;t accept the given encoding. The other\ncompression directives are built upon this one. See its description for an overview how they\nrelate exactly.</dd>\n<dt><a class=\"reference internal\" href=\"compressResponse/#compressresponse\"><em>compressResponse</em></a></dt>\n<dd>Uses the first of a given number of encodings that the client accepts. If none are accepted the request\nis rejected.</dd>\n<dt><a class=\"reference internal\" href=\"compressResponseIfRequested/#compressresponseifrequested\"><em>compressResponseIfRequested</em></a></dt>\n<dd>Only compresses the response when specifically requested by the\n<tt class=\"docutils literal\"><span class=\"pre\">Accept-Encoding</span></tt> request header (i.e. the default is &#8220;no compression&#8221;).</dd>\n</dl>\n<p>See the individual directives for more detailed usage examples.</p>\n</div>\n<div class=\"section\" id=\"when-to-use-which-decompression-directive\">\n<span id=\"whentousewhichdecompressrequestdirective\"></span><h2>When to use which decompression directive?</h2>\n<p>There are two different directives for performing request decompressing with slightly different behavior:</p>\n<dl class=\"docutils\">\n<dt><a class=\"reference internal\" href=\"decodeRequest/#decoderequest\"><em>decodeRequest</em></a></dt>\n<dd>Attempts to decompress the request using <strong>the one given decoder</strong>, rejects the request with an\n<tt class=\"docutils literal\"><span class=\"pre\">UnsupportedRequestEncodingRejection</span></tt> if the request is not encoded with the given encoder.</dd>\n<dt><a class=\"reference internal\" href=\"decompressRequest/#decompressrequest\"><em>decompressRequest</em></a></dt>\n<dd>Decompresses the request if it is encoded with <strong>one of the given encoders</strong>.\nIf the request&#8217;s encoding doesn&#8217;t match one of the given encoders it is rejected.</dd>\n</dl>\n</div>\n<div class=\"section\" id=\"combining-compression-and-decompression\">\n<h2>Combining compression and decompression</h2>\n<p>As with all Spray directives, the above single directives can be combined\nusing <tt class=\"docutils literal\"><span class=\"pre\">&amp;</span></tt> to produce compound directives that will decompress requests and\ncompress responses in whatever combination required. Some examples:</p>\n<div class=\"highlight-scala\"><div class=\"highlight\"><pre><span class=\"s\">&quot;the (decompressRequest &amp; compressResponse) compound directive&quot;</span> <span class=\"n\">should</span> <span class=\"o\">{</span>\n  <span class=\"k\">val</span> <span class=\"n\">decompressCompress</span> <span class=\"k\">=</span> <span class=\"o\">(</span><span class=\"n\">decompressRequest</span><span class=\"o\">()</span> <span class=\"o\">&amp;</span> <span class=\"n\">compressResponse</span><span class=\"o\">())</span>\n  <span class=\"s\">&quot;decompress a GZIP compressed request and produce a GZIP compressed response if the request has no Accept-Encoding header&quot;</span> <span class=\"n\">in</span> <span class=\"o\">{</span>\n    <span class=\"nc\">Get</span><span class=\"o\">(</span><span class=\"s\">&quot;/&quot;</span><span class=\"o\">,</span> <span class=\"n\">helloGzipped</span><span class=\"o\">)</span> <span class=\"o\">~&gt;</span> <span class=\"n\">`Content-Encoding`</span><span class=\"o\">(</span><span class=\"n\">gzip</span><span class=\"o\">)</span> <span class=\"o\">~&gt;</span> <span class=\"o\">{</span>\n      <span class=\"n\">decompressCompress</span> <span class=\"o\">{</span> <span class=\"n\">echoRequestContent</span> <span class=\"o\">}</span>\n    <span class=\"o\">}</span> <span class=\"o\">~&gt;</span> <span class=\"n\">check</span> <span class=\"o\">{</span>\n      <span class=\"n\">response</span> <span class=\"n\">must</span> <span class=\"n\">haveContentEncoding</span><span class=\"o\">(</span><span class=\"n\">gzip</span><span class=\"o\">)</span>\n      <span class=\"n\">body</span> <span class=\"o\">===</span> <span class=\"nc\">HttpEntity</span><span class=\"o\">(</span><span class=\"nc\">ContentType</span><span class=\"o\">(</span><span class=\"n\">`text/plain`</span><span class=\"o\">,</span> <span class=\"n\">`UTF-8`</span><span class=\"o\">),</span> <span class=\"n\">helloGzipped</span><span class=\"o\">)</span>\n    <span class=\"o\">}</span>\n  <span class=\"o\">}</span>\n  <span class=\"s\">&quot;decompress a GZIP compressed request and produce a Deflate compressed response if the request has an `Accept-Encoding: deflate` header&quot;</span> <span class=\"n\">in</span> <span class=\"o\">{</span>\n    <span class=\"nc\">Get</span><span class=\"o\">(</span><span class=\"s\">&quot;/&quot;</span><span class=\"o\">,</span> <span class=\"n\">helloGzipped</span><span class=\"o\">)</span> <span class=\"o\">~&gt;</span> <span class=\"n\">`Content-Encoding`</span><span class=\"o\">(</span><span class=\"n\">gzip</span><span class=\"o\">)</span> <span class=\"o\">~&gt;</span> <span class=\"n\">`Accept-Encoding`</span><span class=\"o\">(</span><span class=\"n\">deflate</span><span class=\"o\">)</span> <span class=\"o\">~&gt;</span> <span class=\"o\">{</span>\n      <span class=\"n\">decompressCompress</span> <span class=\"o\">{</span> <span class=\"n\">echoRequestContent</span> <span class=\"o\">}</span>\n    <span class=\"o\">}</span> <span class=\"o\">~&gt;</span> <span class=\"n\">check</span> <span class=\"o\">{</span>\n      <span class=\"n\">response</span> <span class=\"n\">must</span> <span class=\"n\">haveContentEncoding</span><span class=\"o\">(</span><span class=\"n\">deflate</span><span class=\"o\">)</span>\n      <span class=\"n\">body</span> <span class=\"o\">===</span> <span class=\"nc\">HttpEntity</span><span class=\"o\">(</span><span class=\"nc\">ContentType</span><span class=\"o\">(</span><span class=\"n\">`text/plain`</span><span class=\"o\">,</span> <span class=\"n\">`UTF-8`</span><span class=\"o\">),</span> <span class=\"n\">helloDeflated</span><span class=\"o\">)</span>\n    <span class=\"o\">}</span>\n  <span class=\"o\">}</span>\n  <span class=\"s\">&quot;decompress an uncompressed request and produce a GZIP compressed response if the request has an `Accept-Encoding: gzip` header&quot;</span> <span class=\"n\">in</span> <span class=\"o\">{</span>\n    <span class=\"nc\">Get</span><span class=\"o\">(</span><span class=\"s\">&quot;/&quot;</span><span class=\"o\">,</span> <span class=\"s\">&quot;Hello&quot;</span><span class=\"o\">)</span> <span class=\"o\">~&gt;</span> <span class=\"n\">`Accept-Encoding`</span><span class=\"o\">(</span><span class=\"n\">gzip</span><span class=\"o\">)</span> <span class=\"o\">~&gt;</span> <span class=\"o\">{</span>\n      <span class=\"n\">decompressCompress</span> <span class=\"o\">{</span> <span class=\"n\">echoRequestContent</span> <span class=\"o\">}</span>\n    <span class=\"o\">}</span> <span class=\"o\">~&gt;</span> <span class=\"n\">check</span> <span class=\"o\">{</span>\n      <span class=\"n\">response</span> <span class=\"n\">must</span> <span class=\"n\">haveContentEncoding</span><span class=\"o\">(</span><span class=\"n\">gzip</span><span class=\"o\">)</span>\n      <span class=\"n\">body</span> <span class=\"o\">===</span> <span class=\"nc\">HttpEntity</span><span class=\"o\">(</span><span class=\"nc\">ContentType</span><span class=\"o\">(</span><span class=\"n\">`text/plain`</span><span class=\"o\">,</span> <span class=\"n\">`UTF-8`</span><span class=\"o\">),</span> <span class=\"n\">helloGzipped</span><span class=\"o\">)</span>\n    <span class=\"o\">}</span>\n  <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n</pre></div>\n</div>\n</div>\n</div>\n", "display_toc": true, "title": "EncodingDirectives", "sourcename": "", "customsidebar": null, "current_page_name": "documentation/spray-routing/encoding-directives/index", "next": {"link": "compressResponse/", "title": "compressResponse"}, "rellinks": [["genindex", "General Index", "I", "index"], ["documentation/spray-routing/encoding-directives/compressResponse", "compressResponse", "N", "next"], ["documentation/spray-routing/debugging-directives/logResponse", "logResponse", "P", "previous"]], "meta": {}, "parents": [{"link": "../../", "title": "Documentation"}, {"link": "../", "title": "spray-routing"}, {"link": "../predefined-directives-by-trait/", "title": "Predefined Directives (by trait)"}], "sidebars": null, "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">EncodingDirectives</a><ul>\n<li><a class=\"reference internal\" href=\"#when-to-use-which-compression-directive\">When to use which compression directive?</a></li>\n<li><a class=\"reference internal\" href=\"#when-to-use-which-decompression-directive\">When to use which decompression directive?</a></li>\n<li><a class=\"reference internal\" href=\"#combining-compression-and-decompression\">Combining compression and decompression</a></li>\n</ul>\n</li>\n</ul>\n", "prev": {"link": "../debugging-directives/logResponse/", "title": "logResponse"}, "metatags": ""}